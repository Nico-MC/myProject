<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <title>myproject</title>
    <!-- CSS -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Skranji:700" rel="stylesheet"-->
    <link rel="stylesheet" type="text/css" href="assets/css/page.css">
    <link rel="stylesheet" type="text/css" href="assets/css/game.css">
    <link rel="stylesheet" type="text/css" href="assets/css/auctionhouse.css">
    <link rel="stylesheet" type="text/css" href="assets/css/jquery-ui.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- DATABASE -->
    <!-- <script src="https://www.baqend.com/js-sdk/latest/baqend.min.js"></script> -->
    <!-- <script type="text/javascript" src="//unpkg.com/@reactivex/rxjs@5.2.0/dist/global/Rx.js"></script> -->
    <!-- include the SDK after rxjs -->
    <script type="text/javascript" src="//www.baqend.com/js-sdk/latest/baqend-realtime.js"></script>
    <!-- MODULES -->
    <!-- <script type="text/javascript" src="modules/phaser.min.js"></script> -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.21.0/moment.min.js"></script>
    <script src="modules/moment-timezone-with-data.js"></script>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
  </head>
  <body>
    <section></section>

    <script type="text/javascript" src="js/db_baqend.js"></script>
    <script type="text/javascript">
      // Load mit Vorsicht genießen, da asynchron.
      // Für synchrones Laden: Ajax
      function transferToLogin(sk) {
        if(DB.User.me.securitykey == sk) {
          $.ajax({
            url: "assets/content/content.html",
            success: function(data) {
              var data = $(data).filter('.login_content');
              $('section').html(data);
              init(function() {
                loadLogin(); //race conditions? https://stackoverflow.com/questions/8611145/race-conditions-with-javascript-event-handling
              });
            }
          });

          function loadLogin() {
            getDataForInitload();

            // load user profile_option_div
            $('.profile_option_div .username').text(DB.User.me.username);
            $('.profile_option_div .bankbalance').text(DB.User.me.bankbalance);

            // query-ui slider
            var slider_hours = $("#auction_duration_slider_hours").slider();
            var slider_minutes = $("#auction_duration_slider_minutes").slider();
            var initSlider = function() {
              var options_hours = {
                min: 0,
                max: 48,
                value: 0,
                slide: function(e, ui) {
                  if(ui.value == 0) {
                    slider_minutes.slider("option", "min", 1);
                  }
                  else {
                    slider_minutes.slider("option", "min", 0);
                  }
                  if(ui.value == 48) {
                    slider_minutes.slider("disable");
                    slider_minutes.slider("option", "max", 0);
                  } else {
                    slider_minutes.slider("enable");
                    slider_minutes.slider("option", "max", 59);
                  }

                  var hours = ui.value;
                  var minutes = slider_minutes.slider("value");
                  $('#auctionDuration').val(hours + ":" + minutes);
                }
              }
              slider_hours.slider('option', options_hours);
              var options_minutes = {
                min: 1,
                max: 59,
                value: 0,
                slide: function(e, ui) {
                  var hours = slider_hours.slider("value");
                  var minutes = ui.value;
                  $('#auctionDuration').val(hours + ":" + minutes);
                }
              }
              slider_minutes.slider('option', options_minutes);

              $('#auctionDuration').val("0:1");
            }
            initSlider();

            $('.inventar_item').click(function(e) {
              var target = e.target;
              console.log(target);
            });

            $('#search').submit(function(e) {
              e.preventDefault();
            });

            $('#search_field').keyup(function() {
                searchRealtime();
            });

            // Clear text search_field
            $("#search_field").val("");

            var streamlist;
            $('#check_realtime').change(function() {
              if(checkRealtime() && (streamlist == null)) {
                subscribeRealtime(sk, function(streams) {
                  streamlist = streams;
                  console.log("Realtime is on.");
                });
              } else {
                streamlist.forEach(function(stream) {
                  stream.unsubscribe();
                });
                streamlist = null;
                console.log("All streams unsubscribed.");
                console.log("Realtime is off.");
                clearTimeInterval(timeIntervalID)
                timeIntervalID = null;
              }
            });

            // startGame();
          }
        }
      }

      function transferToRegister() {
        $.ajax({
          url: "assets/content/content.html",
          success: function(data) {
            var data = $(data).filter('.register_container');
            $('section').html(data);
            loadRegister();
          }
        });
        function loadRegister() {
          $('.register_div').fadeIn(2000);
          // Click on register-button
          $("#register").submit(function(event) {
            event.preventDefault();
            register($(this).serializeArray(), function(sk) {
              transferToLogin(sk);
            });
          });
          // Click on login-button
          $("#login").submit(function(event) {
            event.preventDefault();
            login($(this).serializeArray(), function(sk) {
              $.when( $('section .register_container').fadeOut("slow") ).done(function() {
                 transferToLogin(sk);
              });
            });
          });
        }
      }

      function loadItems(itemlist) {
        // if itemlist is not empty:
        function render(callback) {
          itemlist.forEach(function(value, key) {
            if(value.length != 0) {
              $('.inventar_div .no_items').fadeOut('fast').promise().done(function() {
                $(this).remove();
                if($('.inventar_div').find('.inventar_item.' + key).length === 0) {
                  $('<div class="inventar_item '+key+'" draggable="true" ondragstart="drag(event)"><span class="item_number strokeme">'+value.length+'</span></div>').appendTo('.inventar_div').show('slow');
                } else {
                  $('.inventar_item.'+key+' .item_number').html(value.length);
                }
              });
            } else {
              $('.inventar_item.'+key).hide('slow', function() { $(this).remove(); });
            }
          });

          return callback();
        }

        render(function() {
          setTimeout(function() {
            if($('.inventar_div > .inventar_item').length === 0 && $('.inventar_div > .no_items').length === 0) {
              $('.inventar_div').html('<span class="no_items">Keine Items vorhanden.</span>');
              $('.inventar_div .no_items').fadeIn("fast");
            }
          }, 1000);
          resizeAuto();
        });

      }

      function loadAuctionItems(auctions) {
        var auctions = auctions.auctionlist;
        function render() {
          // if auctionlist is not empty:
          if(auctions.length != 0) {
            var auctionElements = [];
            auctions.forEach(function(auction) {
              var name = auction.name;
              var itemlist = auction.itemlist;
              var auctionKey = auction.key;

              $('.auction_div .no_items').fadeOut('fast').promise().done(function() {
                $(this).remove();
                if($('.auction_div').find('.auction_item#' + auctionKey).length === 0) {
                  $('<div id="'+ auctionKey +'" class="auction_item '+name+'" draggable="false" ondragstart="drag(event)"><span class="item_number strokeme">'+itemlist.length+'</span></div>').appendTo('.auction_div').show('slow');
                } else {
                  $('.auction_item.'+name+' .auction_number').html(itemlist.length);
                }
              });
              auctionElements.push(auction.key);
            });

            // This is to filter the old elements and remove them immediately
            if($('.auction_div > .auction_item').length != 0) {
              var loadedElements = $('.auction_div').children().toArray();

              $(loadedElements).each(function(key, val) {
                if($.inArray(val.id, auctionElements) == -1) $(val).hide('slow', function() { $(this).remove(); });
              });
            }
          } else if(auctions.length === 0 && $('.auction_div .no_items').length === 0) {
            $('.auction_div').children().hide("slow").promise().done(function() {
              $('.auction_div').html('<span class="no_items">Keine aktuellen Auktionen.</span>');
              $('.auction_div .no_items').fadeIn("fast");
            });
          }
        }
        render();
        resizeAuto();
      }

      function loadSearchContent(auctions, callback) {
        auctionClassNames = [];
        var callbackCount = 0;
        function render(callback) {
          auctions.forEach(function(auction) {
            var diff = getRemainingTime(auction);

            if(diff.asSeconds() > 1) {
              var auctionName = auction.name;
              var auctionKey = auction.key;
              /* PRICE */
              var auctionUser = auction.user.username;
              var auctionStartingPrice = parseFloat(auction.startingprice).toFixed(2);
              var auctionBuyoutPrice = parseFloat(auction.buyoutprice).toFixed(2);
              var checkAuctionBuyoutPrice = function() {
                if(auctionBuyoutPrice == 0) return '';
                else return '<div class="buyout_price">'+auctionBuyoutPrice+' € (Sofortkauf)</div>'
              };
              var checkAuctionButtons = function() {
                if(auctionUser == DB.User.me.username)
                  return '';
                else if(auction.bidder != null && auction.bidder.username == DB.User.me.username)
                  return "<div class=your_bid>dein gebot</div>";
                else
                  return '<button class="bid_auction_button" type="button" name="button" onclick="clickBidAuctionButton(this)">Bieten</button> \
                          <button class="buy_auction_button" type="button" name="button" onclick="clickBuyAuctionButton(this)">Kaufen</button>';
              };

              if($('.search_content_row#' + auctionKey).length == 0) {
                var html = '<div id="'+auctionKey+'" style="display: none" class="search_content_row flex"> \
                              <div class="auction_item_div category_content flex-child"> \
                                <div class="searched_item '+auctionName+'"><span class="item_number strokeme">'+auction.itemlist.length+'</span></div> \
                              </div> \
                              <div class="auction_bidder_div category_content flex-child"> \
                                <div>'+auctionUser+'</div> \
                              </div> \
                              <div class="auction_end_div category_content flex-child"> \
                                <div class="endtime">'+formatTime(diff)+'</div> \
                              </div> \
                              <div class="auction_price_div category_content flex-child"> \
                                <div class="auction_price"> \
                                  <div class="starting_price">'+auctionStartingPrice+' &euro;</div> \
                                  '+checkAuctionBuyoutPrice()+' \
                                </div> \
                              </div> \
                              <div class="auction_buttons"> \
                                '+checkAuctionButtons()+' \
                              </div> \
                            </div>';

                $(html).appendTo('.search_content_div').show("slow", function() {
                  resizeAuto();
                  auctionTimeDurations.push([$(".search_content_row#"+auctionKey), diff]);
                });
                // console.log(DB.User.me.username == auctionUser);
                // if(auctionUser == DB.User.me.username) $("#" + auctionKey).find(".auction_buttons button").css("color", "#444444");

                // This is for searching after available auctions in search bar (look function: searchRealtime())
                if(auctionClassNames.indexOf(auctionName)) { auctionClassNames.push(auctionName); }
              }

              callbackCount++;
              if(callbackCount == auctions.length) callback();
            }
          });
          var endTimes = $('.endtime');
          if(realtime && timeIntervalID == null) timeIntervalID = setTimeInterval();
        }

        render(function() {
          if(callback != null) return callback();
        });
      }

      function updateItems(items) {
        loadItems(items.data.itemlist);
      }

      function updateAuctionItems(userAuctions) {
        loadAuctionItems(userAuctions);
      }

      function updateSearchContent(auctionTodo) {
        if(auctionTodo.data != null) {
          var matchType = auctionTodo.matchType;
          if(matchType == "add") {
            loadSearchContent([auctionTodo.data], null);
          } else if(matchType == "remove") {
            $('#'+auctionTodo.data.key).hide("slow", function() {
              $(this).remove();
              resizeAuto();
            });
          } else if(matchType == "change") {
            $('#'+auctionTodo.data.key).find(".starting_price").text(parseFloat(auctionTodo.data.startingprice).toFixed(2) + " €");
            if(auctionTodo.data.user.username == DB.User.me.username) {
              var message = "Neues Gebot für folgenden Gegenstand: " + "'" + capitalizeFirstLetter(auctionTodo.data.name) + "'";
              newBidAlert(message, function() {});
            }
            bidThisAuctionMessage(auctionTodo.data);
          }
        } else console.log("ERROR: Couldn't read coming event");
      }

      function realtimeInitSearchContent(auctions) {
          auctionTimeDurations = [];
          $('.search_content_div').children('.search_content_row').hide("slow").promise().done(function() {
            $('.search_content_div').html('');
            loadSearchContent(auctions, function() {
                resizeAuto();
            });
          });
          setTimeout(function() {
            lookAfterExpiredBids(function() {
              lookAfterExpiredAuctions(null, function() {
              });
            });
          }, 4000);
          // lookAfterExpiredBids(function() { resizeAuto(); });
      }

      function searchRealtime() {
        var searchInput = $('#search_field').val().toLowerCase();
        var loadedElements = $('.search_content_row').toArray();
        loadedElements.forEach(function(loadedElement) {
          var className = getClassName($(loadedElement).find(".searched_item").attr("class"), 1).toLowerCase();
          if(className.indexOf(searchInput) > -1) $('.search_content_row#' + loadedElement.id).show("slow", function() { resizeAuto(); });
          else $('.search_content_row#' + loadedElement.id).hide("slow", function() { resizeAuto(); });
        });
      }

      function updateBids(bidsTodo) {
        // console.log(bidsTodo);
      }

      function escapeID(id) {
        // return "#" + id.replace( /(:|\.|\[|\]|,|=|@)/g, "\\$1" );
      }

      function checkRealtime() {
        realtime = $('input[type=checkbox]#check_realtime').prop('checked');
        if(realtime) {
          return true;
        } else {
          return false;
        }
      }

      /* ----- DRAG AND DROP ----- */
      function allowDrop(e) {
        e.preventDefault();
      }

      function drag(e) {
        e.dataTransfer.setData("text", getClassName(e.target.className, 1));
      }

      function drop(e) {
          e.preventDefault();
          resetDrop();
          var classNameToInsert = e.dataTransfer.getData("text");
          // $('.auction_item .background_overflow_div').attr('class', 'background_overflow_div');
          $('.auction_item .background_overflow_div').addClass(classNameToInsert);
          droppedItem = classNameToInsert;
          $('.auction_item_name').text(capitalizeFirstLetter(classNameToInsert));
          $('.auction_item_name_div').show("slow");

      }

      function resetDrop(hideItem) {
        droppedItem = null;
        var getClass = getClassName($('.auction_item .background_overflow_div').attr('class'), 1);
        $('.auction_item .background_overflow_div').removeClass(getClass);
        if(hideItem) $('.auction_item_name_div').hide("slow");
      }

      function getClassName(className, index) {
        return className.split(" ")[index];
      }

      function capitalizeFirstLetter(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
      }

      /* ----- BUTTONS ----- */
      function clickAuctionButton() {
        var startingPrice = $('#startingPrice').val();
        var buyoutPrice = $('#buyOut').val();
        var auctionTime = $('#auctionDuration').val();

        createAuction(startingPrice, buyoutPrice, auctionTime);
      }

      function clickBidAuctionButton(element) {
        var auctionID = $(element).parents(".search_content_row").attr("id");
        bidThisAuction(auctionID);
      }

      function clickBuyAuctionButton(element) {
        var auctionID = $(element).parents(".search_content_row").attr("id");
        buyThisAuction(auctionID);
      }

      function checkBidAuthority(auctionTodo, callback) {

      }
      /* ---------------------- */
      /* ----- TIME START ----- */
      function getRemainingTime(auction) {
        /* TIME */
        var auctionStart = moment(auction.time.start);
        var auctionEnd = moment(auction.time.end);
        // This is for checking the remaining time of all items
        var auctionTimezoneOffset = auction.time.timezoneOffset;
        var now = moment().utcOffset(auctionTimezoneOffset);
        return moment.duration(auctionEnd.diff(now));
      }

      function formatTime(time) {
        var newTime = "";
        if(time.hours() != 0) newTime += time.hours() + ":";
          else newTime += "0:";
        if(time.minutes() != 0) newTime += time.minutes() + ":";
        if(time.seconds() != 0) newTime += time.seconds();
         else newTime += "0";
         return newTime;
      };

      function setTimeInterval() {
        return setInterval(function() {
                            updateAuctionsTime();
                          }, 1000)
      }

      function clearTimeInterval(id) {
        clearInterval(id);
      }

      function updateAuctionsTime() {

        auctionTimeDurations.forEach(function(val, index) {
          var insertTo = val[0];
          var endTime = val[1].subtract(1, "seconds");
          if(endTime.asSeconds() > 0 && endTime.asSeconds() < 11)
            $(insertTo.find(".endtime").css("color", "#980000"));
          if(endTime.asSeconds() < 1) {
            $(insertTo).hide("slow", function() {
              auctionTimeDurations.splice(index, 1)
              lookAfterExpiredBids(function() {
                lookAfterExpiredAuctions(null, function() {
                  resizeAuto();
                });
              });
            });
          }
          $(insertTo.find(".endtime").text(formatTime(endTime)));
        });
      }
      /* ----- TIME END ----- */
      /* -------------------- */

      $(window).resize(function() {
        resizeAuto();
      });

      function resizeAuto(obj) {
        if(obj != null) {
          var target = $(obj).attr("href");
          var oldHeight = $('.tab-pane.active').height();
          $(target).height(oldHeight);
          setTimeout(function() {
            var newHeight = $(target).children('.overflow_div').outerHeight();
            $(".tab-pane.active").height(newHeight);
          }, 300);
        } else {
          if($('#tab3.tab-pane.active').length !== 0 || $('#tab1.tab-pane.active').length !== 0) {
            var overflowHeight = $('.tab-pane.active .overflow_div').outerHeight();
            var tabHeight = $('.tab-pane.active').height();
            if(overflowHeight > tabHeight) {
              $(".tab-pane.active").height($('.tab-pane.active .overflow_div').outerHeight());
            } else if(overflowHeight < tabHeight) {
              $(".tab-pane.active").height($('.tab-pane.active .overflow_div').outerHeight());
            }
          }
        }
      }

      function resizeTo(newOverflowHeight) {
        var overflowHeight = $('#tab1.tab-pane.active').outerHeight();
      }

      window.onclick = function(e) {
        if($('.database_option_div').css('display') == 'block') {
          var target = $(e.target).closest($('.database_option_div')).length;
          if(!target) {
            toggleDatabaseOptions();
          }
        } else if($('.profile_option_div ').css('display') == 'block') {
          var target = $(e.target).closest($('.profile_option_div')).length;
          if(!target) {
            toggleProfileOptions();
          }
        }
      }





      /* ----- JQUERY UX STUFF ----- */
      function errormessage(message) {
        $('.alert').css('color', '#721c24');
        $('.alert').css('background-color', '#f8d7da');
        $('.alert').css('border-color', '#f5c6cb');
        $('.alert').html(message);
        $('.alert').toggle("slow").delay(2000).toggle("slow");
      }

      function registermessage(callback) {
        $('.alert').css('color', '#21721c');
        $('.alert').css('background-color', '#d8f8d7');
        $('.alert').css('border-color', '#c6f5c6');
        $('.alert').html("Registrierung erfolgreich!");
        $('.alert').slideDown("slow").delay(500, function() {
          return callback();
        });
      }

      function createAuctionMessage(message, success) {
        var errorDiv = $('.create_auction_button_error > div');
        if(success) $(errorDiv).css('color', '#1d6e15');
        else $(errorDiv).css('color', '#6c1313');
        $(errorDiv).text(message);
        $(errorDiv).slideDown('slow', function() {
          setTimeout(function() {
            $(errorDiv).slideUp('slow');
          }, 750);
        });
      }

      function bidThisAuctionMessage(auctionTodo) {
        if(auctionTodo.user.username != DB.User.me.username) {
          if(auctionTodo.bidder.username == DB.User.me.username) {
            $("#"+auctionTodo.key).find(".auction_buttons").fadeOut("slow").promise().done(function() {
              $(this).html("<div class=your_bid>dein gebot</div>").fadeIn("slow");
            });
          } else {
            var html = '<button class="bid_auction_button" type="button" name="button" onclick="clickBidAuctionButton(this)">Bieten</button> \
                        <button class="buy_auction_button" type="button" name="button" onclick="clickBuyAuctionButton(this)">Kaufen</button>';
            $("#"+auctionTodo.key).find(".your_bid").fadeOut("slow").promise().done(function() {
              $("#"+auctionTodo.key).find(".auction_buttons").html(html);
              $(".bid_auction_button").css("display", "none");
              $(".buy_auction_button").css("display", "none");
              $(".bid_auction_button").fadeIn("slow");
              $(".buy_auction_button").fadeIn("slow");
            });
          }
        }
      }

      function auctionExpiredAlert(expiredAuctions, callback) {
        if(expiredAuctions.length != 0) {
          if(expiredAuctions.length == 1) $(".expired_auction_div_two").text(expiredAuctions.length + " Auktion ist abgelaufen.");
          else $(".expired_auction_div_two").text(expiredAuctions.length + " Auktionen ist abgelaufen.");
          var width = $(".expired_auction_div_two").width();

          $('.expired_auction_div_two').show().animate({"left": "-=220"}, "slow", function() {
            setTimeout(function() {
              $('.expired_auction_div_two').animate({"left": "100%"}, "slow", function() { $(this).hide(); });
            }, 1000);
          });
          // $(".expired_auction_div_two").slideDown("slow", function() {
          //   setTimeout(function() {
          //     $(".expired_auction_div_two").slideUp("slow", function() {
          //       return callback();
          //     });
          //   }, 1000);
          // });
        } else return callback();
      }

      function bidExpiredAlert(bids, callback) {
        if(bids.length != 0) {
          if(bids.length == 1) $(".expired_auction_div").text("Du hast " + bids.length + " Auktion gewonnen.");
          else $(".expired_auction_div").text("Du hast " + bids.length + " Auktionen gewonnen.");
          $(".expired_auction_div").slideDown("slow", function() {
            setTimeout(function() {
              $(".expired_auction_div").slideUp("slow");
            }, 1000);
          });
        }
      }

      function newBidAlert(message, callback) {
        var timeout = 0;
        if($(".expired_auction_div").css("display") != "none") timeout = 1000;

        setTimeout(function() {
          $(".expired_auction_div").text(message);
          $(".expired_auction_div").slideDown("slow", function() {
            setTimeout(function() {
              $(".expired_auction_div").slideUp("slow");
            }, 1000);
          });
        }, timeout);
      }

      function switchRegister() {
        if($('.register_div #register').css('display') != 'none') {
          $('.register_div #register').slideUp("slow", function() {
            $('.register_div #login').slideDown("slow");
          });
        } else {
          $('.register_div #login').slideUp("slow", function() {
            $('.register_div #register').slideDown("slow");
          });
        }
      }

      function toggleDatabaseButton() {
        if($('.simulate_button_gradient').css('display') == 'none') $('.simulate_button_gradient').fadeIn("slow");
        else $('.simulate_button_gradient').fadeOut("slow");
      }

      function toggleDatabaseOptions() {
        if(!($('.profile_option_div').css('display') == 'none')) toggleProfileOptions();
        if($('.database_option_div').css('display') == 'none') $('.database_option_div').slideDown("slow");
        else $('.database_option_div').slideUp("slow");
      }

      function toggleProfileOptions() {
        if(!($('.database_option_div').css('display') == 'none')) toggleDatabaseOptions();
        if($('.profile_option_div').css('display') == 'none') $('.profile_option_div').slideDown("slow");
        else $('.profile_option_div').slideUp("slow");
      }

    </script>

    <!-- LOADING GAME -->
    <script type="text/javascript" src="js/states/Boot.js"></script>
    <script type="text/javascript" src="js/states/Preload.js"></script>
    <script type="text/javascript" src="js/states/Menu.js"></script>
    <script type="text/javascript" src="js/states/game/Game.js"></script>
    <script type="text/javascript" src="js/states/game/Movement.js"></script>
    <script type="text/javascript" src="js/states/game/Ui.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
  </body>
</html>
